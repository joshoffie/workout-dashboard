<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Workout Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- ✅ Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js";

        // ✅ Your Firebase settings (replace with your actual project config)
        window.firebaseConfig = {
            apiKey: "AIzaSyAywTTfFa6K7heVmkOUQDKpGJbeAbJ_8a8",
            authDomain: "free-workout-tracker.firebaseapp.com",
            projectId: "free-workout-tracker",
            storageBucket: "free-workout-tracker.firebasestorage.app",
            messagingSenderId: "797968203224",
            appId: "1:797968203224:web:0409faf864741f9e5c86ad",
        };

        // Expose Firebase globally so app.js can use it
        const app = initializeApp(window.firebaseConfig);
        window.db = getFirestore(app);
        window.auth = getAuth(app);
        window.provider = new GoogleAuthProvider();

        window.startFirebaseLogin = function () {
            signInWithPopup(window.auth, window.provider)
                .catch(err => alert("Login failed: " + err.message));
        };

        onAuthStateChanged(window.auth, (user) => {
            const status = document.getElementById("loginStatus");
            if (user) {
                status.innerHTML = `✅ Logged in as: ${user.displayName}`;
                window.currentUser = user;
            } else {
                status.innerHTML = "❌ Not logged in";
                window.currentUser = null;
            }
        });
    </script>

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        select, button { margin: 5px; }
        table { border-collapse: collapse; margin-top: 10px; }
        table, th, td { border: 1px solid black; padding: 5px; }
    </style>
</head>

<body>
    <h1>Client Workout Dashboard</h1>

    <!-- ✅ Login UI -->
    <button onclick="startFirebaseLogin()">Login with Google</button>
    <p id="loginStatus">❌ Not logged in</p>

    <label for="clientSelect">Select Your Name:</label>
    <select id="clientSelect">
        <option value="">-- Select --</option>
    </select>

    <div id="sessionsDiv"></div>
    <div id="exercisesDiv"></div>
    <div id="progressTableDiv"></div>
    <div id="progressGraphDiv" style="width:100%;height:400px;"></div>

    <script src="app.js"></script>
</body>
</html>
